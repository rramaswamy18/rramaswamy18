@using ArchitectureLibraryCacheData
@using ArchitectureLibraryModels
@using RetailSlnCacheData
@using RetailSlnModels
@{
    ViewBag.Title = "ItemCatalog";
    Layout = "~/Views/Shared/_Layout2.cshtml";
    #region Backend Code
    PaymentInfoModel paymentInfoModel = (PaymentInfoModel)Session["PaymentInfo"];
    if (paymentInfoModel != null && paymentInfoModel.ShoppingCartModel != null)
    {
        paymentInfoModel.ShoppingCartModel.Checkout = false;
    }
    SessionObjectModel sessionObjectModel = (SessionObjectModel)Session["SessionObject"];
    SessionObjectModel createForSessionObject = (SessionObjectModel)Session["CreateForSessionObject"];
    var aspNetRoleNameProxy = createForSessionObject?.AspNetRoleNameProxy;
    if (aspNetRoleNameProxy == null)
    {
        aspNetRoleNameProxy = "DEFAULTROLE";
    }
    Dictionary<string, AspNetRoleKVPModel> aspNetRoleKVPs = ArchLibCache.AspNetRoleKVPs[aspNetRoleNameProxy];
    var parentCategoryId = long.Parse(aspNetRoleKVPs["ParentCategoryId01"].KVPValueData);
    long? corpAcctId = ((ApplSessionObjectModel)createForSessionObject?.ApplSessionObjectModel)?.CorpAcctModel.CorpAcctId;
    if (corpAcctId == null)
    {
        corpAcctId = 0;
    }
    List<CategoryItemMasterHierModel> categoryCategoryItemMasterHierModels = RetailSlnCache.AspNetRoleParentCategoryCategoryModels[aspNetRoleNameProxy][0];
    #endregion
}
<style>
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
        opacity: 1;
    }

    .dataStyle1Left {
        font-family: Arial;
        font-size: 13px;
        font-style: normal;
        padding: 5px;
        text-align: left;
        vertical-align: top;
    }

    .dataStyle1Center {
        font-family: Arial;
        font-size: 13px;
        font-style: normal;
        padding: 5px;
        text-align: center;
        vertical-align: top;
    }

    .dataStyle1Right {
        font-family: Arial;
        font-size: 13px;
        font-style: normal;
        padding: 5px;
        text-align: right;
        vertical-align: top;
    }

    .hrefStyle {
        color: #ff0000;
        font-family: Arial;
        font-size: 12px;
        font-weight: bold;
        text-decoration: underline;
    }
</style>
<table class="table table-bordered table-condensed table-responsive" style="border: none !important; margin-bottom: 0px; margin-left: auto; margin-right: auto; padding: 0px; width: 81%;">
    <tr>
        <th class="dataStyle1Left" style="border: none !important; vertical-align: middle;">
            @Html.DropDownList("ParentCategoryId", new SelectList(categoryCategoryItemMasterHierModels, "CategoryModel.CategoryId", "CategoryModel.CategoryDesc", null), "--- Select Catalog ---", new { @class = "form-control", onchange = "javascript: ParentCategoryId_onclick();", style = "float: left; font-size: 14px; font-weight: normal; width: 54%;", title = "Select category to view the catalog" })
            <span id="spnParentCategoryId" style="display: none;"></span>
            <span id="spnParentCategoryDesc" style="color: #0000ff; float: left; font-size: 18px; font-weight: bold; padding-left: 9px; padding-top: 3px;"></span>
            <span id="spnItemMasterCount" style="color: #ff0000; float: left; font-size: 14px; font-weight: bold; padding-left: 5px; padding-top: 8px;"></span>
            <span style="color: #000000; float: left; font-size: 14px; font-weight: bold; padding-left: 5px; padding-top: 8px;">/</span>
            <span id="spnItemCount" style="color: #a54000; float: left; font-size: 15px; font-weight: bold; padding-left: 5px; padding-top: 8px;"></span>
        </th>
        <th class="dataStyle1Left" style="border: none !important; vertical-align: middle;">
            <input class="form-control" id="txtSearchText" name="txtSearchText" placeholder="Search inside catalog..." style="float: left; font-weight: normal; width: 63%;" type="text" title="Search in this page..." />
            <input id="btnSearchText" name="btnSearchText" onclick="javascript: btnSearchText_onclick(1);" style="background-color: #ffffff; border-style: none; color: #000000; float: left; font-weight: bold; padding-left: 9px; padding-top: 9px; text-decoration: underline;" type="button" value="Search" />
        </th>
    </tr>
</table>
<div id="divItemCatalogData" style="padding: 0px;">
</div>
<script type="text/javascript">
    //var dOMElementIds;
    //var searchDOMElements, searchDOMElementIndex;
    function window_onload() {
        ParentCategoryId_onclick();
    }
    function ParentCategoryId_onclick() {
        console.log("ParentCategoryId_onclick", "00000000", "ENTER!!!");
        $("#loadingModal").modal({ backdrop: 'static', keyboard: false });
        var parentCategoryIdElement = document.getElementById("ParentCategoryId");
        var parentCategoryId = parentCategoryIdElement.value;
        document.getElementById("spnParentCategoryId").innerText = parentCategoryId;
        parentCategoryIdElement.selectedIndex = 0;
        var url = "@Url.Action("ItemCatalogData", "Home")?parentCategoryId=" + parentCategoryId;
        $.ajax({
            url: url,
            type: "GET",
            //async: false,
            //contentType: "application/json; charset=utf-8",
            //dataType: "json",
            //data: jsonPostData,
            success: function (responseData, textStatus, request) {
                document.getElementById("divItemCatalogData").innerHTML = responseData;
                document.getElementById("spnParentCategoryId").innerText = document.getElementById("spnParentCategoryIdWork").innerText;
                document.getElementById("spnParentCategoryDesc").innerText = document.getElementById("spnParentCategoryDescWork").innerText;
                document.getElementById("spnItemMasterCount").innerText = document.getElementById("spnItemMasterCountWork").innerText;
                document.getElementById("spnItemCount").innerText = document.getElementById("spnItemCountWork").innerText;
                document.getElementById("divScrollIntoView").scrollIntoView();
                $('#loadingModal').modal('hide');
                console.log("ParentCategoryId_onclick", "00001000", "SUCCESS!!!", textStatus);
            },
            error: function (xhr, exception) {
                $('#loadingModal').modal('hide');
                console.log("ParentCategoryId_onclick", "00099000", "ERROR???");
                console.log(xhr, exception);
            }
        });
    }
    function btnSearchText_onclick(pageNum) {
        console.log("btnSearchText_onclick", "00000000", "ENTER!!!");
        $("#loadingModal").modal({ backdrop: 'static', keyboard: false });
        var url = "@Url.Action("SearchText", "Home")";
        var searchText = document.getElementById("txtSearchText").value;
        var parentCategoryId = document.getElementById("spnParentCategoryId").innerText;
        var jsonPostData =
        {
            "parentCategoryId": parentCategoryId,
            "searchText": searchText,
            "pageNum": pageNum,
        };
        $.ajax({
            url: url,
            type: "POST",
            //async: false,
            //contentType: "application/json; charset=utf-8",
            dataType: "text",
            data: jsonPostData,
            success: function (responseData, textStatus, request) {
                $('#loadingModal').modal('hide');
                document.getElementById("divItemCatalogData").innerHTML = responseData;
                console.log("btnSearchText_onclick", "00001000", "SUCCESS!!!", textStatus);
            },
            error: function (xhr, exception) {
                $('#loadingModal').modal('hide');
                console.log("btnSearchText_onclick", "00099000", "ERROR???");
                console.log(xhr, exception);
            }
        });
    }
</script>
